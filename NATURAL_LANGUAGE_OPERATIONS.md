# 自然语言操作说明文档

## 功能简介

本系统支持通过自然语言描述来操作各种数据结构，系统会自动将您的自然语言指令转换为相应的操作并执行。这项功能基于大语言模型（LLM）实现，让您可以用日常语言来描述数据结构操作，无需记忆复杂的命令语法。

### 主要优势

- **直观易用**：使用自然语言描述，无需学习专门的命令语法
- **智能理解**：系统能理解多种表达方式，自动识别数据结构类型和操作意图
- **实时转换**：自动将自然语言转换为系统可执行的操作指令
- **可视化反馈**：操作结果实时显示在可视化界面上

## 使用方法

### 访问方式

1. **菜单栏访问**：点击菜单栏中的 `AI助手` -> `自然语言操作`
2. **快捷键访问**：按下 `Ctrl+L` 快速打开对话框

### 操作步骤

1. 打开自然语言操作对话框
2. 在输入框中输入您的操作描述（中文或英文均可）
3. 点击"执行"按钮
4. 系统会自动调用LLM服务，将您的描述转换为操作指令并执行
5. 查看执行结果和转换后的操作指令

### 示例输入

```
创建一个包含数据元素[5,3,7,2,4]的二叉搜索树
```

系统会自动转换为：
```json
{
  "structure_type": "BST",
  "operation": "create",
  "parameters": {
    "values": ["5","3","7","2","4"]
  }
}
```

## 支持的数据结构操作

### 1. SequentialList (顺序表)

#### 支持的操作

- **create** - 创建顺序表
- **insert** - 在指定位置插入元素
- **delete** - 删除指定位置的元素

#### 自然语言示例

- `创建一个包含1,2,3的顺序表`
- `在顺序表的第1个位置插入4`
- `删除顺序表中位置0的元素`
- `在顺序表头部插入10`
- `在顺序表尾部插入20`

### 2. LinkedList (链表)

#### 支持的操作

- **create** - 创建链表
- **insert** - 在指定位置插入节点
- **delete** - 删除指定位置的节点

#### 自然语言示例

- `创建一个包含10,20,30的链表`
- `在链表的第1个位置插入15`
- `删除链表中位置2的节点`
- `在链表头部插入5`
- `在链表尾部插入100`

### 3. Stack (栈)

#### 支持的操作

- **create** - 创建空栈
- **push** - 入栈操作
- **pop** - 出栈操作

#### 自然语言示例

- `创建一个空栈`
- `将100压入栈中`
- `从栈中弹出一个元素`
- `执行出栈操作`

### 4. BinaryTree (二叉树)

#### 支持的操作

- **create** - 创建二叉树（层序构建）
- **insert** - 插入节点（需要指定父节点和位置）

#### 自然语言示例

- `创建一个包含1,2,3,4,5的二叉树`
- `在节点3的左侧插入6`
- `在节点3的右侧插入7`
- `将节点8插入为节点4的左孩子`

### 5. BST (二叉搜索树)

#### 支持的操作

- **create** - 创建二叉搜索树
- **insert** - 插入节点（自动维护BST性质）
- **search** - 查找节点
- **delete** - 删除节点

#### 自然语言示例

- `创建一个包含数据元素[5,3,7,2,4]的二叉搜索树`
- `在BST中插入25`
- `在二叉搜索树中查找60`
- `从BST中删除30`
- `删除二叉搜索树中的节点50`

### 6. AVL (AVL平衡树)

#### 支持的操作

- **create** - 创建AVL树
- **insert** - 插入节点（自动平衡）
- **clear** - 清空树

#### 自然语言示例

- `创建一个包含7,19,16的AVL树`
- `创建一个包含7,19,16,27,9,5的AVL平衡树`
- `在AVL树中插入25`
- `清空AVL树`
- `重置AVL树`

### 7. HuffmanTree (哈夫曼树)

#### 支持的操作

- **build** - 构建哈夫曼树（需要提供频率映射）

#### 自然语言示例

- `构建一个哈夫曼树，频率映射为a:5,b:9,c:12,d:13,e:16,f:45`
- `创建哈夫曼树，字符A频率25，字符B频率15，字符C频率27`
- `使用频率映射a:25,b:15,c:27,d:5,e:30构建哈夫曼树`

## 操作示例

### 完整操作流程示例

#### 示例1：创建并操作二叉搜索树

```
1. 创建一个包含50,30,70,20,40,60,80的二叉搜索树
2. 在BST中插入25
3. 在二叉搜索树中查找60
4. 从BST中删除30
```

#### 示例2：顺序表操作

```
1. 创建一个包含1,2,3的顺序表
2. 在顺序表的第1个位置插入4
3. 删除顺序表中位置0的元素
4. 在顺序表尾部插入10
```

#### 示例3：栈操作

```
1. 创建一个空栈
2. 将100压入栈中
3. 将200压入栈中
4. 从栈中弹出一个元素
```

#### 示例4：AVL树操作

```
1. 创建一个包含7,19,16,27,9,5,14,11,17,12的AVL树
2. 在AVL树中插入25
3. 清空AVL树
```

## 注意事项

### 环境配置

1. **API密钥设置**：使用自然语言功能前，需要设置 `OPENROUTER_API_KEY` 环境变量
   - Windows: 在系统环境变量中设置
   - Linux/Mac: 在 `~/.bashrc` 或 `~/.zshrc` 中设置 `export OPENROUTER_API_KEY="your_key"`

2. **网络连接**：需要能够访问 OpenRouter API 服务

### 数据格式要求

1. **数值格式**：所有数值都以字符串形式提供（如 `"5"` 而不是 `5`）
2. **位置索引**：位置参数从0开始计数
3. **二叉树插入**：插入位置可以是 `"left"` 或 `"right"`

### 操作限制

1. **单次操作**：每次输入建议只描述一个操作，确保准确性
2. **数据结构选择**：系统会根据当前选中的数据结构类型进行转换，建议先切换到目标数据结构
3. **错误处理**：如果转换失败，系统会提示您尝试手动输入DSL命令

## 故障排除

### 常见问题

#### 1. "未设置OPENROUTER_API_KEY环境变量"

**问题描述**：执行自然语言命令时提示API密钥未设置

**解决方案**：
- 检查系统环境变量中是否已设置 `OPENROUTER_API_KEY`
- 如果已设置，重启应用程序
- 确保环境变量名称拼写正确（区分大小写）

#### 2. "LLM转换失败"

**问题描述**：系统无法将自然语言转换为操作指令

**可能原因**：
- 输入描述不够明确
- 数据结构类型识别错误
- 操作参数缺失或格式不正确

**解决方案**：
- 使用更明确的描述，包含数据结构类型和具体操作
- 明确指定参数值，如位置、数值等
- 如果持续失败，可以尝试使用DSL命令方式

#### 3. "执行失败"

**问题描述**：转换成功但执行失败

**可能原因**：
- 操作参数超出范围（如位置索引越界）
- 数据结构状态不满足操作条件（如栈已满、节点已存在等）

**解决方案**：
- 检查操作参数是否合理
- 确认数据结构当前状态是否支持该操作
- 查看错误提示信息，根据提示调整操作

#### 4. 网络连接问题

**问题描述**：无法连接到LLM服务

**解决方案**：
- 检查网络连接是否正常
- 确认代理设置是否正确（如果使用代理）
- 检查防火墙是否阻止了API请求

### 替代方案

如果自然语言功能无法使用，您可以：

1. **使用DSL命令**：在左侧面板的"DSL命令"区域直接输入DSL命令
2. **使用GUI操作**：通过界面上的按钮和输入框进行操作
3. **查看DSL示例**：参考 `example_commands.dsl` 文件中的命令格式

## 技术说明

### 工作原理

1. **自然语言输入**：用户输入自然语言描述
2. **LLM转换**：系统调用OpenRouter API，使用大语言模型将自然语言转换为JSON格式的操作指令
3. **动作执行**：系统解析JSON指令，执行相应的数据结构操作
4. **可视化反馈**：操作结果实时显示在可视化界面上

### 转换格式

系统会将自然语言转换为以下格式的JSON：

```json
{
  "structure_type": "数据结构类型",
  "operation": "操作类型",
  "parameters": {
    "参数名": "参数值"
  }
}
```

### 支持的语言

- 中文（简体）
- 英文

系统可以理解多种表达方式，例如：
- "创建"、"建立"、"构建"
- "插入"、"添加"、"加入"
- "删除"、"移除"、"去掉"

## 更新日志

- **v1.0** - 初始版本，支持7种数据结构的自然语言操作

## 相关文档

- [DSL命令说明](example_commands.dsl) - DSL命令格式参考
- [README.md](README.md) - 项目整体说明
- [数据结构架构文档](structures/ARCHITECTURE.md) - 数据结构实现细节

